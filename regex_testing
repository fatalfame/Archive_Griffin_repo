Date(datedts) as NextEventDT,
    dateid AS DateID,
	weekid AS WeekID,
	monthid AS MonthID,
	quarterid AS QuarterID,
	halfyearid AS HalfYearID,
	yearid AS YearID,
	//fiscalweekid AS FiscalWeekID,
	//fiscalmonthid AS FiscalMonthID,
	//fiscalquarterid AS FiscalQuarterID,
	//fiscalhalfyearid AS FiscalHalfYearID,
	yearstartdts AS YearStartDTS,
	yearenddts AS YearEndDTS,
	//fiscalyearstartdts AS FiscalYearStartDTS,
	//fiscalyearenddts AS FiscalYearEndDTS,
	yearnbr AS YearNBR,
	yearmonthnbr AS YearMonthNBR,
	yearmonthdaynbr AS YearMonthDayNBR,
	yearquarternbr AS YearQuarterNBR,
	yearquarternm AS YearQuarterNM,
	quarternbr AS QuarterNBR,
	quarternm AS QuarterNM,
	calendarhalfnbr AS CalendarHalfNBR,
	calendarhalfnm AS CalendarHalfNM,
	calendarhalfyearnm AS CalendarHalfYearNM,
	//fiscalhalfnbr AS FiscalHalfNBR,
	//fiscalhalfnm AS FiscalHalfNM,
	//fiscalhalfyearnm AS FiscalHalfYearNM,
	yearmonthnm AS YearMonthNM,
	yearmonthabbreviatednm AS YearMonthAbbreviatedNM,
	monthnbr AS MonthNBR,
	monthnm AS MonthNM,
	monthabbreviatednm AS MonthAbbreviatedNM,
	monthstartdts AS MonthStartDTS,
	monthenddts AS MonthEndDTS,
	yearweeknm AS YearWeekNM,
	weekofyearnbr AS WeekOfYearNBR,
	weekstartdts AS WeekStartDTS,
	date(floor(weekstartdts))AS WeekStartDT,
	weekenddts AS WeekEndDTS,
	dayofyearnbr AS DayOfYearNBR,
	dayofmonthnbr AS DayOfMonthNBR,
	dayofweeknbr AS DayOfWeekNBR,
	//fiscalyearnbr AS FiscalYearNBR,
	//fiscalyearmonthnbr AS FiscalYearMonthNBR,
	//fiscalyearmonthdaynbr AS FiscalYearMonthDayNBR,
	//fiscalyearquarternbr AS FiscalYearQuarterNBR,
	//fiscalquarternbr AS FiscalQuarterNBR,
	//fiscalmonthnbr AS FiscalMonthNBR,
	//fiscalweeknbr AS FiscalWeekNBR,
	//fiscalyearquarternm AS FiscalYearQuarterNM,
	//fiscalyearmonthnm AS FiscalYearMonthNM,
	//fiscalyearmonthabbreviatednm AS FiscalYearMonthAbbreviatedNM,
	//fiscalyearweeknm AS FiscalYearWeekNM,
	weekdaynm AS WeekdayNM,
	weekdayofmonthnbr AS WeekDayOfMonthNBR,
	isweekendflg AS IsWeekendFLG,
	isholidayflg AS IsHolidayFLG,
	isleapyearflg AS IsLeapYearFLG,
	monthtotalworkdaycnt AS MonthTotalWorkDayCNT,
	dayofweeknumberabbreviatednm AS DayOfWeekNumberAbbreviatedNM,
	dayofweekabbreviatednm AS DayOfWeekAbbreviatedNM,
	daytypedsc AS DayTypeDSC,
	monthnumberabbreviatednm AS MonthNumberAbbreviatedNM,
    1 AS DayCNT

discharge
    COUNT({<NextEventTypeDSC={'Departure'}, NextEventDT = {">=$(=min(EventDT))<=$(=max(EventDT))"}>} DISTINCT PatientEncounterID)


    =If(%GT1NBR = 1
	,COUNT({<EventTypeDSC={'Admission'}, PatientTypeCD={'IP'}>} DISTINCT PatientEncounterID)
	,COUNT({<EventTypeDSC={'Admission'}, PatientTypeCD={'IP'}, $(tLast7Days)>} DISTINCT PatientEncounterID)
	)
